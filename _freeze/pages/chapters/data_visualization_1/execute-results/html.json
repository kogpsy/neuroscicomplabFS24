{
  "hash": "cfa1e4f3cf4a2fd265a57b96338fe989",
  "result": {
    "markdown": "---\ntitle: \"Grafiken erstellen mit `ggplot`\"\ndescription: Einf√ºhrung in das `ggplot2`-Package.\nauthor:\n  - name: Gerda Wyssen\n    affiliation: Kognitive Psychologie, Wahrnehmung und Methodenlehre, Universit√§t Bern \n    affiliation-url: https://www.kog.psy.unibe.ch\n    orcid: 0000-0001-7427-3149\n  - name: Daniel Fitze\n    affiliation: Kognitive Psychologie, Wahrnehmung und Methodenlehre, Universit√§t Bern \n    affiliation-url: https://www.kog.psy.unibe.ch\n    orcid: 0000-0003-0158-7459 \nlicense: CC BY\ncitation: true\nformat:\n    html:\n        toc: true\n        code-link: true\nexecute: \n  cache: false\n---\n\n\n\n\n::: callout-caution\n## Hands-on: Vorbereitung\n\n-   Laden Sie [hier](../../downloadable_files/DatasaurusDozen.csv) den Beispielsdatensatz herunter, speichern Sie diesen in einem `data`-Folder in einem _R-Project_.\n\n- √ñffnen Sie ein neues RScript (`.R`) oder RMarkdown-File (`.Rmd`). In einem RMarkdown-File k√∂nnen Code und Text verbunden werden und die die Outputs des Codes (z.B. Grafiken) werden anzeigt.\n\n:::\n\n\n# Grafiken erstellen mit `ggplot` \n\nDas `gg` im _Package_ `ggplot2` steht f√ºr *Grammar of Graphics*. Diese besagt, dass alle Grafiken aus den unten beschriebenen Komponenten zusammengesetzt werden k√∂nnen und sich damit vollst√§ndig beschreiben lassen. Das Kennen dieser Komponenten macht den anfangs oft etwas unintuitiven Aufbau von `ggplot` verst√§ndlicher.\n\n<aside>Mit `ggplot`k√∂nnte man sogar Kunstwerke erstellen, wie bspw. [hier](https://www.data-imaginist.com/art) gezeigt wird.</aside>\n\nEine Grafik enth√§lt mindestens folgende 3 Komponenten: \n\n-   **Daten**\n\n-   **Geome**, also sichtbare Formen (*aesthetics*), z.B. Punkte, Linien oder Boxen.\n\n-   **Koordinatensystem/Mapping**: wie sind Daten und Geome verbunden?\n\nWeitere optionale Komponenten sind:\n\n-   Statistische Parameter\n\n-   Position\n\n-   Koordinatenfunktionen\n\n-   **Facets**\n\n-   Scales\n\n-   **Themes**\n\nIn dieser Einf√ºhrung wird auf die ersten drei Komponenten, sowie auf _Facets_ und _Themes_ eingegangen.\n\nBeim Laden des _Packages_ `tidyverse` wird automatisch das _Package `ggplot2` ebenfalls geladen.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n:::\n\n\n\n## Daten\n \nDie wichtigste Komponente einer Grafik sind die Daten. Bevor eine Grafik erstellt wird, m√ºssen die Eigenschaften des Datensatzes bekannt sein.\n\n<aside>Der verwendete Datensatz stammt von @matejka_same_2017. </aside>\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Einlesen des √úbungsdatensatzes\ndata <- read.csv(\"data/DatasaurusDozen.csv\") %>%\n    mutate(condition = as.factor(condition)) # Variable condition soll ein Faktor sein\n\n# Datensatz anschauen\nglimpse(data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 1,846\nColumns: 3\n$ condition <fct> away, away, away, away, away, away, away, away, away, away, ‚Ä¶\n$ value1    <dbl> 32.33111, 53.42146, 63.92020, 70.28951, 34.11883, 67.67072, ‚Ä¶\n$ value2    <dbl> 61.411101, 26.186880, 30.832194, 82.533649, 45.734551, 37.11‚Ä¶\n```\n:::\n:::\n\n\n### Datenformat\n\nAm einfachsten ist das plotten mit `ggplot()`, wenn die Daten im *long*-Format vorliegen. Das bedeutet:\n\n- Jede Variable die gemessen/erhoben wird hat eine Spalte (z.B. Versuchspersonennummer, Reaktionszeit, Taste). \n\n- Jede Messung hat eine Zeile. In unserem PsychoPy-Experiment entspricht dies einer Zeile pro Trial. \n\nDie hier eingelesenen Daten sind schon im *long*-Format. \n\n<aside> Falls die Daten im *wide*-Format abgespeichert sind, lohnt es sich diese umzuformatieren z.B. mit `pivot_longer()`. </aside>\n\n\n### Variablen\n\nF√ºr die Grafik ist es relevant, welches Skalenniveau die zu visualisierenden Variablen haben. Je nach Anzahl Variablen und den entsprechenden Skalenniveaus eignen sich andere Grafik-Formen. \n\n![CC BY-SA 3.0, https://commons.wikimedia.org/w/index.php?curid=724035](img/skalenniveau.png)\n\n::: callout-caution\n## Hands-on: Datensatz anschauen\n\nSchauen Sie sich den Datensatz an. \n\n- Wie viele unterschiedliche Variablen gibt es? \n- Wie heissen die Variablen? \n- Welches Skalenniveau haben sie?\n\n:::\n\n### Subsetting\n\nWenn nur ein gewisser Teil der Daten visualisiert werden soll, muss der Datensatz gefiltert werden. Der aktuelle Datensatz enth√§lt beispielsweise verschiedene Bedingungen, jeweils mit Werten f√ºr Variable `value1` und `value2`. Folgende 13 Bedingungen sind enthalten:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nunique(data$condition)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] away       bullseye   circle     dino       dots       h_lines   \n [7] high_lines slant_down slant_up   star       v_lines    wide_lines\n[13] x_shape   \n13 Levels: away bullseye circle dino dots h_lines high_lines ... x_shape\n```\n:::\n:::\n\n\nF√ºrs erste entscheiden wir uns f√ºr die Bedingung `away`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_away <- data %>%\n    filter(condition == \"away\")\n```\n:::\n\n\n\nWir k√∂nnen f√ºr diese Bedingung zus√§tzlich *summary statistics* berechnen, hier Mittelwert und Standardabweichung.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_away_summary <- data %>%\n    summarise(mean_v1 = mean(value1),\n              sd_v1 = sd(value1),\n              mean_v2 = mean(value2),\n              sd_v2 = sd(value2))\n\nglimpse(data_away_summary)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 1\nColumns: 4\n$ mean_v1 <dbl> 54.2657\n$ sd_v1   <dbl> 16.713\n$ mean_v2 <dbl> 47.8351\n$ sd_v2   <dbl> 26.84777\n```\n:::\n:::\n\n\nDiese Werte geben einen Anhaltspunkt, in welchem Bereich sich die Werte bewegen werden. \n\n\n### Plot\n\nIn den folgenden Beispielen werden die Daten der Bedingung `away` verwendet. Als erstes Argument wird der Funktion `ggplot()` der Datensatz √ºbergeben (`data = data_away`).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = data_away)\n```\n\n::: {.cell-output-display}\n![](data_visualization_1_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nDa noch keine Formen und kein Mapping eingegeben wurden ist die Grafik leer. \n\n\n## Geom / Formen\n\nAls zweite Komponente werden in `ggplot()` wird die Form mit `geom_` hinzugef√ºgt. Beispielsweise werden mit `geom_point()` Punkte erstellt, mit `geom_line()` Linien, mit `geom_boxplot` Boxplots, usw. Bei der Wahl der passenden Form kommt es einerseits auf die Daten an. Sind die Daten z.B. Faktoren oder numerische Werte (siehe auch Skalenniveau oben)?  Wie viele Variablen werden gleichzeitig in die Grafik eingebunden? Andererseits ist es wichtig, was mit der Grafik gezeigt werden soll: Unterschiede? Gemeinsamkeiten? Ver√§nderungen √ºber Zeit? \n\nOft verwendete Formen sind:\n\n- Punkte / Scatterplots - `geom_point()`\n- Linien - `geom_line()`\n\nOder wenn zusammenfassende Werte geplottet werden sollen:\n\n- Histogramme - `geom_histogram()`\n- Mittelwerte und Standardabweichungen - `geom_pointrange()`\n- Dichte - `geom_density()`\n- Boxplots - `geom_boxplot()`\n- Violinplots - `geom_violin()`\n\n<aside>Es gibt auch weitere, informative Arten der Darstellung wie *heat maps* oder *shift functions*, auf die wir in dieser Veranstaltung nicht eingehen.</aside>\n\n::: callout-caution\n## Hands-on\n\nWelche `geoms` eignen sich f√ºr welches Skalenniveau und welche Variablenanzahl?\n\nüëâ [Hier](https://github.com/rstudio/cheatsheets/blob/main/data-visualization.pdf) finden Sie das `ggplot`-Cheatsheet.\n\nSchauen Sie sich die verschiedenen Formen von Plots [hier](https://www.data-to-viz.com) an. \n\n:::\n \n \nBeim Ausf√ºhren dieses Codes\n\n```\nggplot(data = data_away) +\n    geom_point()\n```\nenth√§lt man eine Fehlermeldung, weil nicht angegeben wurde __wie__ die Daten mit der Form `geom` verbunden werden soll: Das `mapping` fehlt.\n\n## Mapping\n\nJede `geom`-Funktion in `ggplot` ben√∂tigt Angaben zum `mapping`: die dritte Komponente. Damit wird definiert, wie die Variablen auf die Formen (*aesthetics*) gemappt werden sollen. Am einfachsten wir dies zu Beginn in festgelegt (das `mapping` kann aber auch in der Funktion `geom_` selbst definiert werden). \n\nDas `mapping` beschreibt, welche Variable auf der x- und y-Achse abgetragen werden sollen. Weitere Variablen k√∂nnten als `group = ...` oder `color = ...` eingef√ºgt werden.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = data_away,\n       mapping = aes(x = value1,\n                     y = value2)) +\n    geom_point()\n```\n\n::: {.cell-output-display}\n![](data_visualization_1_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n## Beschriftungen und Themes\n\nSch√∂nere und informativere Plots lassen sich gestalten, wenn wir einen Titel hinzuf√ºgen, die Achsenbeschriftung anpassen und das `theme` ver√§ndern:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = data_away,\n       mapping = aes(x = value1,\n                     y = value2)) +\n    geom_point() +\n    ggtitle (\"Ein etwas sch√∂nerer Plot\") +\n    xlab(\"Wert 1 [a.u.]\") +\n    ylab(\"Wert 2 [a.u.]\") +\n    theme_minimal()\n```\n\n::: {.cell-output-display}\n![](data_visualization_1_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n<aside> Auch `theme_classic()` oder `theme_bw()` ergeben schlichte aber sch√∂ne Plots. </aside>\n\n# Daten plotten: Hands on\n\nIm Folgenden k√∂nnen Sie den Datensatz mit Grafiken erkunden. Sie k√∂nnen entweder in Ihrem RSkript/RMarkdown-File weiterarbeiten oder Sie k√∂nnen ein GUI (graphical user interface) verwenden, dass f√ºr Sie den Code schreibt.\n\n::: callout-note\n## Tipp: GUI\nUm das GUI zu verwenden, gehen Sie wie folgt vor: \n\n- Installieren Sie das package `esquisse` mit `install.packages(\"esquisse\")` in Ihrer Konsole oder √ºber `Tools` > `Install packages...`\n\n- Geben Sie in Ihrer Konsole `esquisse::esquisser()` ein und w√§hlen Sie dann unter `Import Data` den schon eingelesenen Datensatz `DatasaurusDozen.csv` aus.\n:::\n\n<aside>Ein weiteres `R`-basiertes Visualisierungstool in welchem der Code per GUI erstellt wird, ist [trelliscopejs](https://hafen.github.io/trelliscopejs/)</aside>\n\n\n::: callout-caution\n## Hands-on: Informative Grafik erstellen\n\n- Welche `geom_`s/Formen eignen sich gut f√ºr diesen Datensatz? \n\n- Welche Abbildungen k√∂nnen alle 3 Variablen des Datensatzes ber√ºcksichtigen?\n\n- Wie kann man Bedingungen miteinander vergleichen?\n\n- Wie k√∂nnen Gr√∂sse und Farbe der `geom_`s bestimmt werden?\n\n- Wie passt man Schriftgr√∂ssen an?\n\n- K√∂nnen Sie eine Grafik speichern?\n\n- Lassen Sie sich den Code direkt ins RScript/RMarkdown-File einf√ºgen und ver√§ndern Sie den Code dort weiter.\n\n:::\n\n## Weitere hilfreiche Informationen\n\n- [Dokumentation](https://ggplot2.tidyverse.org/) von `ggplot2`\n\n- Kurzweilige, sehr informative Informationen und Videos √ºber das Erstellen von Grafiken in `ggplot` finden Sie hier: [Website PsyTeachR: Data Skills for reproducible research](https://psyteachr.github.io/reprores-v3)\n\n- [Hier](https://youtu.be/90IdULVGmYY) ist der Start der PsyTeachR Videoliste von Lisa deBruine, dort finden sich auch hilfreiche Kurzvideos zu Themen von Daten einlesen bis zu statistischen Analysen. Beispielsweise zu [Basic Plots](https://youtu.be/tOFQFPRgZ3M), [Common Plots](https://youtu.be/kKlQupjD__g) und [Plot Themes and Customization](https://youtu.be/6pHuCbOh86s)\n\n- [Einf√ºhrung in R](https://methodenlehre.github.io/einfuehrung-in-R/chapters/05-plotting.html) von Andrew Ellis und Boris Mayer\n\n",
    "supporting": [
      "data_visualization_1_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}